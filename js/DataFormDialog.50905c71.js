import{_ as k}from"./index.8beb34c5.js";import{ag as n,o as p,c,P as s,H as a,K as u,a as b,O as y,a4 as D,G as w,L as V,M as v}from"./vendor-vue.ad8ef945.js";const H={host:[{message:"\u4E3B\u673A\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],user:[{message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],password:[{message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],private_key:[{message:"\u79D8\u94A5\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},f={PASSWORD:1,PRIVATE_KEY:2},S=[{label:"\u5BC6\u7801",value:f.PASSWORD},{label:"\u79C1\u94A5\u8BC1\u4E66",value:f.PRIVATE_KEY}];function q(o){var e;return(e=S.find(r=>r.value===o))==null?void 0:e.label}const O={name:"RemoteHostForm",props:{row:{type:Object,default:null}},components:{},data(){return{rules:H,HostAuthTypeEnum:f,HostAuthTypeOptions:S,form:{host:"",port:"22",user:"",auth_type:f.PASSWORD,password:"",private_key:""}}},computed:{},methods:{async getData(){if(console.log(this.row),this.row&&this.row.id){const o=await this.getHostById(this.row.id);for(let e in this.form)this.form[e]=o[e]}else this.row&&this.row.host&&(this.form.host=this.row.host)},async getHostById(o){let e={host_id:o};return(await this.$http.getHostById(e)).data},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(o=>{if(o)this.confirmSubmit();else return!1})},async confirmSubmit(){let o=this.$loading({fullscreen:!0}),e={host:this.form.host,port:this.form.port,user:this.form.user,password:this.form.password,private_key:this.form.private_key,auth_type:this.form.auth_type},r=null,h=null;if(this.row&&this.row.id?(h=this.row.id,e.host_id=this.row.id,r=await this.$http.updateHostById(e),{...this.row,...e}):(r=await this.$http.addHost(e),r.data,h=r.data.id),r.code==0){this.$msg.success("\u64CD\u4F5C\u6210\u529F");let t=await this.getHostById(h);this.$emit("on-success",t)}else this.$msg.error(r.msg);this.$nextTick(()=>{o.close()})}},created(){this.getData()}},T={class:"remote-host"},A={class:"flex"},B={class:"text-center"};function E(o,e,r,h,t,i){const d=n("el-input"),m=n("el-form-item"),_=n("el-option"),x=n("el-select"),C=n("el-form"),g=n("el-button");return p(),c("div",T,[s(C,{ref:"form",model:t.form,rules:t.rules,"label-width":"100px"},{default:a(()=>[u(" \u4E3B\u673A\u5730\u5740 "),s(m,{label:"\u4E3B\u673A\u5730\u5740",prop:"host"},{default:a(()=>[b("div",A,[s(d,{type:"text",modelValue:t.form.host,"onUpdate:modelValue":e[0]||(e[0]=l=>t.form.host=l),placeholder:"\u4E3B\u673A\u5730\u5740"},null,8,["modelValue"]),s(d,{class:"remote-host__port-input",type:"text",modelValue:t.form.port,"onUpdate:modelValue":e[1]||(e[1]=l=>t.form.port=l),placeholder:"\u7AEF\u53E3\u53F7"},null,8,["modelValue"])])]),_:1}),u(" \u9A8C\u8BC1\u7C7B\u578B "),s(m,{label:"\u7528\u6237\u540D",prop:"user"},{default:a(()=>[s(d,{type:"text",modelValue:t.form.user,"onUpdate:modelValue":e[2]||(e[2]=l=>t.form.user=l),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),u(" \u9A8C\u8BC1\u65B9\u5F0F "),s(m,{label:"\u9A8C\u8BC1\u65B9\u5F0F",prop:"auth_type"},{default:a(()=>[s(x,{modelValue:t.form.auth_type,"onUpdate:modelValue":e[3]||(e[3]=l=>t.form.auth_type=l)},{default:a(()=>[(p(!0),c(y,null,D(t.HostAuthTypeOptions,l=>(p(),w(_,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(" \u79D8\u94A5 "),t.HostAuthTypeEnum.PRIVATE_KEY==t.form.auth_type?(p(),w(m,{key:0,label:"\u79C1\u94A5\u8BC1\u4E66",prop:"private_key"},{default:a(()=>[s(d,{type:"textarea",rows:5,modelValue:t.form.private_key,"onUpdate:modelValue":e[4]||(e[4]=l=>t.form.private_key=l),"show-password":"",spellcheck:!1,placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5\u8BC1\u4E66"},null,8,["modelValue"])]),_:1})):(p(),c(y,{key:1},[u(" \u5BC6\u7801 "),s(m,{label:"\u5BC6\u7801",prop:"password"},{default:a(()=>[s(d,{type:"password",modelValue:t.form.password,"onUpdate:modelValue":e[5]||(e[5]=l=>t.form.password=l),"show-password":"",autocomplete:"new-password",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1})],2112))]),_:1},8,["model","rules"]),u(" \u64CD\u4F5C "),b("div",B,[s(g,{onClick:i.handleCancel},{default:a(()=>[V(v(o.$t("\u53D6\u6D88")),1)]),_:1},8,["onClick"]),s(g,{type:"primary",onClick:i.handleSubmit},{default:a(()=>[V(v(o.$t("\u786E\u5B9A")),1)]),_:1},8,["onClick"])])])}const I=k(O,[["render",E]]),R={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:I},data(){return{}},computed:{dialogTitle(){return this.row&&this.row.id?"\u7F16\u8F91\u4E3B\u673A":"\u6DFB\u52A0\u4E3B\u673A"},dialogVisible:{get(){return this.visible},set(o){this.$emit("update:visible",o)}}},methods:{handleClose(){this.$emit("update:visible",!1)},handleOpen(){this.$emit("update:visible",!0)},handleSuccess(o){this.handleClose(),this.$emit("on-success",o)}},created(){}};function F(o,e,r,h,t,i){const d=n("DataForm"),m=n("el-dialog");return p(),c(y,null,[u(" \u7F16\u8F91\u6846 "),s(m,{title:i.dialogTitle,modelValue:i.dialogVisible,"onUpdate:modelValue":e[0]||(e[0]=_=>i.dialogVisible=_),width:"400px",center:"","append-to-body":""},{default:a(()=>[i.dialogVisible?(p(),w(d,{key:0,row:r.row,onOnCancel:i.handleClose,onOnSuccess:i.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):u("v-if",!0)]),_:1},8,["title","modelValue"])],2112)}const K=k(R,[["render",F]]);export{K as D,q as g};
