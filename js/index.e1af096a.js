import{C as $}from"./ConnectStatus.4f268ada.js";import{_}from"./index.7ea3d62d.js";import{ag as i,o as f,c as b,P as a,H as l,a as r,M as c,aq as z,I as k,L as m}from"./vendor-vue.5e429edb.js";import"./element-plus.af1c8bed.js";import"./element-icon.65c0b9c3.js";import"./vendor-lib.cd48dffd.js";const v={name:"",components:{ConnectStatus:$},props:{list:{type:Array}},computed:{},data(){return{currentRow:null,dialogVisible:!1}},methods:{handleEditRow(e){this.currentRow=e,this.dialogVisible=!0},async handleDeleteClick(e){let t={id:e.id};const d=await this.$http.function(t);d.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(d.msg)},async handleStatusChange(e){let t={id:e.id};const d=await this.$http.function(t);d.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(d.msg)},handleUpdateSuccess(){this.$emit("on-success")}},created(){}};function T(e,t,d,w,o,p){const n=i("el-table-column"),u=i("ConnectStatus"),h=i("el-table");return f(),b("div",null,[a(h,{data:d.list,stripe:"",border:""},{default:l(()=>[a(n,{label:e.$t("\u5E8F\u53F7"),align:"center",prop:"id",width:"60"},{default:l(s=>[r("span",null,c(s.$index+1),1)]),_:1},8,["label"]),a(n,{label:e.$t("\u7528\u6237"),"header-align":"center",align:"center",prop:"create_time",width:"140"},{default:l(s=>[r("span",null,c(s.row.user_name||"-"),1)]),_:1},8,["label"]),a(n,{label:e.$t("\u4EFB\u52A1\u540D\u79F0"),"header-align":"center",align:"center",width:"180",prop:"create_time"},{default:l(s=>[r("span",null,c(s.row.task_name||"-"),1)]),_:1},8,["label"]),a(n,{label:e.$t("\u5F00\u59CB\u65F6\u95F4"),"header-align":"center",align:"center",width:"180",prop:"create_time"},{default:l(s=>[r("span",null,c(s.row.start_time||"-"),1)]),_:1},8,["label"]),a(n,{label:e.$t("\u7ED3\u675F\u65F6\u95F4"),"header-align":"center",align:"center",width:"180",prop:"end_time"},{default:l(s=>[r("span",null,c(s.row.end_time||"-"),1)]),_:1},8,["label"]),a(n,{label:e.$t("\u6301\u7EED\u65F6\u95F4"),"header-align":"center",align:"center",width:"80",prop:"total_time_label"},{default:l(s=>[r("span",null,c(s.row.total_time_label||"-"),1)]),_:1},8,["label"]),a(n,{label:e.$t("\u72B6\u6001"),"header-align":"center",align:"center",prop:"status",width:"60"},{default:l(s=>[a(u,{value:s.row.status},null,8,["value"])]),_:1},8,["label"]),a(n,{label:e.$t("\u6267\u884C\u7ED3\u679C"),"header-align":"center",align:"center",prop:"status"},{default:l(s=>[r("span",null,c(s.row.result||"-"),1)]),_:1},8,["label"])]),_:1},8,["data"])])}const V=_(v,[["render",T]]),R={name:"log-scheduler-list",props:{},components:{DataTable:V},data(){return{list:[],total:0,page:1,size:20,keywords:"",loading:!0,dialogVisible:!1,pageSizeCachekey:"pageSize"}},computed:{},methods:{resetData(){this.page=1,this.getData()},refreshData(){this.getData()},async getData(){this.loading=!0;let e={ticket:this.ticket,page:this.page,size:this.size,keywords:this.keywords};const t=await this.$http.getAsyncTaskLogList(e);t.code==0&&(this.list=t.data.list,this.total=t.data.total),this.loading=!1},handleAddRow(){this.dialogVisible=!0},handleAddSuccess(){this.resetData()},handleSizeChange(e){localStorage.setItem(this.pageSizeCachekey,e),this.resetData()},loadPageSize(){let e=localStorage.getItem(this.pageSizeCachekey);e&&(this.size=parseInt(e))},async handleBatchDeleteConfirm(){let e=this.$loading({fullscreen:!0});try{const t=await this.$http.clearAsyncTaskLogList();t.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.resetData()):this.$msg.error(t.msg)}catch(t){console.log(t)}finally{this.$nextTick(()=>{e.close()})}}},created(){this.loadPageSize(),this.getData()}},A={class:"app-container"},B={class:"flex justify-end mb-sm"};function L(e,t,d,w,o,p){const n=i("Delete"),u=i("el-icon"),h=i("el-link"),s=i("el-popconfirm"),C=i("Refresh"),y=i("DataTable"),D=i("el-pagination"),S=z("loading");return f(),b("div",A,[r("div",B,[t[2]||(t[2]=r("div",null,null,-1)),a(s,{title:"\u786E\u5B9A\u6E05\u7A7A\u65E5\u5FD7\uFF1F",onConfirm:p.handleBatchDeleteConfirm},{reference:l(()=>[a(h,{underline:!1,type:"danger",class:"mr-sm"},{default:l(()=>[a(u,null,{default:l(()=>[a(n)]),_:1}),m(c(e.$t("\u6E05\u7A7A\u65E5\u5FD7")),1)]),_:1})]),_:1},8,["onConfirm"]),a(h,{underline:!1,type:"primary",disabled:o.loading,onClick:p.getData},{default:l(()=>[a(u,null,{default:l(()=>[a(C)]),_:1}),m(c(e.$t("\u5237\u65B0")),1)]),_:1},8,["disabled","onClick"])]),k(a(y,{list:o.list,onOnSuccess:p.resetData},null,8,["list","onOnSuccess"]),[[S,o.loading]]),a(D,{class:"mt-md justify-center",background:"",layout:"total, sizes, prev, pager, next",total:o.total,"page-size":o.size,"onUpdate:pageSize":t[0]||(t[0]=g=>o.size=g),"current-page":o.page,"onUpdate:currentPage":t[1]||(t[1]=g=>o.page=g),onCurrentChange:p.getData,onSizeChange:p.handleSizeChange},null,8,["total","page-size","current-page","onCurrentChange","onSizeChange"])])}const O=_(R,[["render",L]]);export{O as default};
